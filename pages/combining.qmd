---
title: "Combining Excel and Delimited Data"
format: html
toc: TRUE
editor_options: 
  chunk_output_type: console
---

## Task 3: Combining Excel and Delimited Data

-  Import data from first sheet using readxl package.
```{r}
library(readxl)
white_wine_data <- read_excel("../white-wine.xlsx")
print(white_wine_data)
```

-  Read in the data from the 2nd sheet.
```{r}
variables <- read_excel("../white-wine.xlsx", 
                            sheet = excel_sheets("../white-wine.xlsx")[2])
variables
```
-  Rename variables with backticks and add type variable.

```{r}
library(dplyr)
  white_wine_data<-white_wine_data %>%
  rename("fixed_acidity"=`fixed acidity`,
         "volatile_acidity"=`volatile acidity`,
         "citric_acid"=`citric acid`,
         "residual_sugar"=`residual sugar`,
         "free_sulfur_dioxide"=`free sulfur dioxide`,
         "total_sulfur_dioxide"=`total sulfur dioxide`,
         ) |> mutate("type"="white")

str(white_wine_data)
```
-   Read the red wine csv


```{r}
library(readr)
red_wine_data <-read_csv2("https://www4.stat.ncsu.edu/~online/datasets/red-wine.csv",show_col_types =FALSE)
red_wine_data

```

- change character data types to numeric
```{r}
red_wine_data <- red_wine_data %>%
  mutate(across(where(is.character), as.numeric))

```
-  Rename variables with backticks and add type variable

```{r}
red_wine_data<-red_wine_data %>%
  rename("fixed_acidity"=`fixed acidity`,
         "volatile_acidity"=`volatile acidity`,
         "citric_acid"=`citric acid`,
         "residual_sugar"=`residual sugar`,
         "free_sulfur_dioxide"=`free sulfur dioxide`,
         "total_sulfur_dioxide"=`total sulfur dioxide`,
         ) |> mutate("type"="red")
```

- Combine the two data sets.
- filter, sort, select, mutate and sort the combined data set
```{r}
dplyr::bind_rows(white_wine_data,red_wine_data)|> filter(quality >6.5,alcohol <132)|>arrange(desc(quality))|>select(citric_acid, alcohol, type, quality)|>group_by(quality) |>mutate(across(alcohol,list(mean=mean,sd=sd),.names = "{.col}_{.fn}"))
```

